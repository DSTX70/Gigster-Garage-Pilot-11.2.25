✅ **Repo:** **GigsterGarage**
And yes — we can start **CI-only audits** without touching DTH code. DTH becomes the place you *import results into Work Items*, but the audit runner lives in the repo CI.

Below is a **paste-ready starter kit** using **GitHub Actions + Lighthouse CI + Pa11y** (a11y). It audits your **published URL** (not localhost), runs on demand + nightly, and uploads reports as artifacts.

---

## 0) One secret you must set (GitHub repo settings)

In **GigsterGarage → GitHub → Settings → Secrets and variables → Actions**, add:

* `AUDIT_BASE_URL` = `https://gigster-garage-pilot-11225--dustinsparks1.replit.app`

(You can later add an `AUDIT_URLS` list, but this is enough to start.)

---

## 1) Add workflow: `.github/workflows/website-audit.yml`

```yaml
name: Website Audit (Lighthouse + A11y)

on:
  workflow_dispatch:
  schedule:
    - cron: "0 9 * * *" # daily at 09:00 UTC

jobs:
  audit:
    runs-on: ubuntu-latest
    timeout-minutes: 25

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: npm

      - name: Install dependencies
        run: npm ci

      - name: Install audit tools
        run: npm i -D @lhci/cli pa11y-ci

      - name: Run Lighthouse CI
        env:
          AUDIT_BASE_URL: ${{ secrets.AUDIT_BASE_URL }}
        run: npx lhci autorun --config=./.lighthouserc.json

      - name: Run Accessibility (Pa11y)
        env:
          AUDIT_BASE_URL: ${{ secrets.AUDIT_BASE_URL }}
        run: npx pa11y-ci --config ./.pa11yci.json

      - name: Upload audit artifacts
        uses: actions/upload-artifact@v4
        with:
          name: website-audit-artifacts
          path: |
            artifacts/lhci/**
            artifacts/pa11y/**
          if-no-files-found: error
```

---

## 2) Add Lighthouse config: `.lighthouserc.json`

This targets a few key pages. Start logged-out (no auth).

```json
{
  "ci": {
    "collect": {
      "url": [
        "${AUDIT_BASE_URL}/",
        "${AUDIT_BASE_URL}/login",
        "${AUDIT_BASE_URL}/agency-hub"
      ],
      "numberOfRuns": 3,
      "settings": {
        "onlyCategories": ["performance", "accessibility", "best-practices", "seo"]
      }
    },
    "assert": {
      "assertions": {
        "categories:performance": ["warn", { "minScore": 0.6 }],
        "categories:accessibility": ["warn", { "minScore": 0.75 }],
        "categories:best-practices": ["warn", { "minScore": 0.75 }],
        "categories:seo": ["warn", { "minScore": 0.7 }]
      }
    },
    "upload": {
      "target": "filesystem",
      "outputDir": "artifacts/lhci"
    }
  }
}
```

> Note: The `${AUDIT_BASE_URL}` interpolation works because we pass `AUDIT_BASE_URL` as an env var in the workflow.

---

## 3) Add Pa11y config: `.pa11yci.json`

```json
{
  "defaults": {
    "timeout": 60000,
    "wait": 1000,
    "standard": "WCAG2AA",
    "reporter": [
      "json",
      "cli"
    ]
  },
  "urls": [
    "${AUDIT_BASE_URL}/",
    "${AUDIT_BASE_URL}/login",
    "${AUDIT_BASE_URL}/agency-hub"
  ]
}
```

Pa11y will output JSON to stdout; we’ll capture it into an artifact by tee-ing it below.

If you want JSON files saved automatically, change the workflow step to:

```yaml
- name: Run Accessibility (Pa11y)
  env:
    AUDIT_BASE_URL: ${{ secrets.AUDIT_BASE_URL }}
  run: |
    mkdir -p artifacts/pa11y
    npx pa11y-ci --config ./.pa11yci.json --json > artifacts/pa11y/pa11y.json
```

---

## 4) Optional: add npm scripts (nice-to-have)

**Repo:** GigsterGarage
**File:** `package.json`

```json
{
  "scripts": {
    "audit:lighthouse": "lhci autorun --config=./.lighthouserc.json",
    "audit:a11y": "pa11y-ci --config ./.pa11yci.json"
  }
}
```

---

## What you’ll get after the first run

In GitHub Actions → run → **Artifacts**:

* `artifacts/lhci/` (Lighthouse reports + manifests)
* `artifacts/pa11y/pa11y.json` (a11y issues list)

---

## How DTH fits in (without extra wiring)

* Upload the `pa11y.json` + LHCI outputs into a DTH Work Item (as evidence)
* Use **Pilot G** to draft intent/strategy from the audit findings
* Use **Pilot F** to generate a patch drop after approval

---

## Next upgrade after this starter

If you want “logged-in audits” (Agency Hub behind auth), we’ll add Playwright to:

* log in
* save auth state
* run Lighthouse against authenticated pages

That’s the next milestone once the basic pipeline is green.

If you want, paste your repo’s CI platform (GitHub Actions yes/no) and confirm the exact published URL you want audited, and I’ll tailor the URL list + thresholds to GigsterGarage’s real pages.
